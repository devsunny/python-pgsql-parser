<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostgreSQL SQL Parser Documentation</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #2ecc71;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Navigation */
        .sidebar {
            width: 280px;
            background: var(--primary);
            color: white;
            padding: 20px 0;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .sidebar ul {
            list-style: none;
            padding: 20px 0;
        }
        
        .sidebar li {
            padding: 5px 0;
        }
        
        .sidebar a {
            display: block;
            color: var(--light);
            text-decoration: none;
            padding: 8px 30px;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }
        
        .sidebar a:hover, .sidebar a.active {
            background: rgba(255,255,255,0.1);
            border-left: 3px solid var(--secondary);
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        section {
            margin-bottom: 60px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary);
        }
        
        h2 {
            font-size: 2rem;
            color: var(--primary);
            margin: 30px 0 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        h3 {
            font-size: 1.5rem;
            color: var(--dark);
            margin: 25px 0 15px;
        }
        
        h4 {
            font-size: 1.2rem;
            color: var(--dark);
            margin: 20px 0 10px;
        }
        
        p {
            margin: 15px 0;
        }
        
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 20px 0;
            font-size: 0.95rem;
        }
        
        code {
            font-family: 'Fira Code', 'Consolas', monospace;
        }
        
        .code-block {
            position: relative;
        }
        
        .code-header {
            background: #3d3d3d;
            color: #ccc;
            padding: 8px 15px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
        }
        
        .btn-copy {
            background: none;
            border: none;
            color: #ccc;
            cursor: pointer;
        }
        
        .btn-copy:hover {
            color: white;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: white;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .feature-card h4 {
            color: var(--secondary);
            margin-top: 0;
        }
        
        .api-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .api-table th, .api-table td {
            border: 1px solid #eee;
            padding: 12px 15px;
            text-align: left;
        }
        
        .api-table th {
            background: var(--primary);
            color: white;
        }
        
        .api-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        .example-container {
            background: #f0f8ff;
            border-left: 4px solid var(--secondary);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }
        
        .example-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .example-title {
            color: var(--secondary);
            font-weight: bold;
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .btn {
            padding: 10px 20px;
            background: var(--secondary);
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #2980b9;
        }
        
        .btn-prev {
            background: var(--dark);
        }
        
        .btn-prev:hover {
            background: #2c3e50;
        }
        
        .footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 40px;
            border-top: 1px solid #eee;
            color: #777;
        }
        
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            
            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>PostgreSQL SQL Parser</h2>
                <p>v0.1.0 Documentation</p>
            </div>
            <ul>
                <li><a href="#overview" class="active">Overview</a></li>
                <li><a href="#installation">Installation</a></li>
                <li><a href="#quick-start">Quick Start</a></li>
                <li><a href="#core-concepts">Core Concepts</a></li>
                <li><a href="#api-reference">API Reference</a></li>
                <li><a href="#examples">Examples</a></li>
                <li><a href="#advanced-usage">Advanced Usage</a></li>
                <li><a href="#contributing">Contributing</a></li>
                <li><a href="#license">License</a></li>
            </ul>
        </aside>
        
        <main class="main-content">
            <section id="overview">
                <h1>PostgreSQL SQL Parser</h1>
                <p>A powerful Python library for parsing PostgreSQL DDL (Data Definition Language) scripts and extracting comprehensive database schema metadata.</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <h4>Schema Extraction</h4>
                        <p>Extract database, schema, table, and column definitions with all metadata including data types, constraints, and relationships.</p>
                    </div>
                    <div class="feature-card">
                        <h4>PostgreSQL Support</h4>
                        <p>Handles PostgreSQL-specific syntax including quoted identifiers, custom data types, and advanced DDL features.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Large Script Processing</h4>
                        <p>Efficiently processes large SQL scripts with statement-by-statement parsing and metadata extraction.</p>
                    </div>
                    <div class="feature-card">
                        <h4>Comprehensive API</h4>
                        <p>Provides intuitive methods to access parsed schema information through Python objects and methods.</p>
                    </div>
                </div>
            </section>
            
            <section id="installation">
                <h2>Installation</h2>
                <p>Install the package using pip:</p>
                
                <div class="code-block">
                    <div class="code-header">
                        <span>Terminal</span>
                        <button class="btn-copy">Copy</button>
                    </div>
                    <pre><code>pip install python-pgsql-parser</code></pre>
                </div>
                
                <h3>Requirements</h3>
                <ul>
                    <li>Python 3.7 or higher</li>
                    <li>No external dependencies</li>
                </ul>
            </section>
            
            <section id="quick-start">
                <h2>Quick Start</h2>
                <p>Get started with the PostgreSQL SQL Parser in just a few lines of code:</p>
                
                <div class="code-block">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="btn-copy">Copy</button>
                    </div>
                    <pre><code>from pgsql_parser import SQLParser

# Initialize parser
parser = SQLParser()

# Parse SQL script
sql_script = """
CREATE TABLE public.users (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    email VARCHAR(255) UNIQUE
);
"""

parser.parse_script(sql_script)

# Get all tables
tables = parser.get_tables()
for table in tables:
    print(f"Table: {table.schema}.{table.name}")
    for col_name, column in table.columns.items():
        print(f"  {col_name}: {column.data_type}")</code></pre>
                </div>
                
                <div class="example-container">
                    <div class="example-header">
                        <div class="example-title">Output</div>
                    </div>
                    <pre>Table: public.users
  id: serial
  name: varchar
  email: varchar</pre>
                </div>
            </section>
            
            <section id="core-concepts">
                <h2>Core Concepts</h2>
                
                <h3>Tokenization</h3>
                <p>The lexer converts SQL input into tokens (keywords, identifiers, literals, etc.) using regular expressions.</p>
                
                <h3>Parsing</h3>
                <p>The parser processes tokens to identify database objects and their properties.</p>
                
                <h3>Schema Objects</h3>
                <ul>
                    <li><strong>Table</strong>: Represents a database table with columns, constraints, and relationships</li>
                    <li><strong>Column</strong>: Contains metadata about a table column (data type, constraints, etc.)</li>
                    <li><strong>PrimaryKey</strong>: Represents a primary key constraint</li>
                    <li><strong>ForeignKey</strong>: Represents a foreign key relationship</li>
                    <li><strong>Constraint</strong>: Represents table constraints (CHECK, UNIQUE, etc.)</li>
                </ul>
            </section>
            
            <section id="api-reference">
                <h2>API Reference</h2>
                
                <h3>SQLParser Class</h3>
                <p>The main parser class for processing SQL scripts and statements.</p>
                
                <table class="api-table">
                    <thead>
                        <tr>
                            <th>Method</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>parse_script(sql_script: str)</code></td>
                            <td>Parse entire SQL script</td>
                        </tr>
                        <tr>
                            <td><code>parse_statement(sql: str) -> Optional[Table]</code></td>
                            <td>Parse single SQL statement</td>
                        </tr>
                        <tr>
                            <td><code>get_tables() -> List[Table]</code></td>
                            <td>Get all parsed tables/views</td>
                        </tr>
                        <tr>
                            <td><code>get_table(name: str, schema: str, database: str) -> Optional[Table]</code></td>
                            <td>Get specific table by qualified name</td>
                        </tr>
                        <tr>
                            <td><code>statement_generator(sql_script: str) -> Generator[str, None, None]</code></td>
                            <td>Iterate through SQL statements</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Table Class</h3>
                <p>Represents a database table or view.</p>
                
                <table class="api-table">
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>name</code></td>
                            <td>Table name</td>
                        </tr>
                        <tr>
                            <td><code>schema</code></td>
                            <td>Schema name (if any)</td>
                        </tr>
                        <tr>
                            <td><code>database</code></td>
                            <td>Database name (if any)</td>
                        </tr>
                        <tr>
                            <td><code>table_type</code></td>
                            <td>Type ('TABLE', 'VIEW', 'MATERIALIZED VIEW')</td>
                        </tr>
                        <tr>
                            <td><code>columns</code></td>
                            <td>Dictionary of Column objects</td>
                        </tr>
                        <tr>
                            <td><code>primary_key</code></td>
                            <td>PrimaryKey object (if defined)</td>
                        </tr>
                        <tr>
                            <td><code>foreign_keys</code></td>
                            <td>List of ForeignKey objects</td>
                        </tr>
                        <tr>
                            <td><code>constraints</code></td>
                            <td>List of Constraint objects</td>
                        </tr>
                        <tr>
                            <td><code>is_view</code></td>
                            <td>True if the object is a view</td>
                        </tr>
                        <tr>
                            <td><code>view_definition</code></td>
                            <td>SQL definition for views</td>
                        </tr>
                    </tbody>
                </table>
                
                <h3>Column Class</h3>
                <p>Represents a column in a database table.</p>
                
                <table class="api-table">
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>name</code></td>
                            <td>Column name</td>
                        </tr>
                        <tr>
                            <td><code>data_type</code></td>
                            <td>Data type (e.g., 'varchar', 'int')</td>
                        </tr>
                        <tr>
                            <td><code>char_length</code></td>
                            <td>Character length for string types</td>
                        </tr>
                        <tr>
                            <td><code>numeric_precision</code></td>
                            <td>Precision for numeric types</td>
                        </tr>
                        <tr>
                            <td><code>numeric_scale</code></td>
                            <td>Scale for numeric types</td>
                        </tr>
                        <tr>
                            <td><code>nullable</code></td>
                            <td>True if column allows NULL values</td>
                        </tr>
                        <tr>
                            <td><code>default</code></td>
                            <td>Default value expression</td>
                        </tr>
                        <tr>
                            <td><code>is_primary</code></td>
                            <td>True if part of primary key</td>
                        </tr>
                        <tr>
                            <td><code>primary_key_position</code></td>
                            <td>Position in primary key (if applicable)</td>
                        </tr>
                        <tr>
                            <td><code>foreign_key_ref</code></td>
                            <td>Foreign key reference (ref_table, ref_col, constraint_name)</td>
                        </tr>
                    </tbody>
                </table>
            </section>
            
            <section id="examples">
                <h2>Examples</h2>
                
                <h3>Basic Table Parsing</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="btn-copy">Copy</button>
                    </div>
                    <pre><code>sql = """
CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) CHECK (price > 0),
    category_id INT REFERENCES categories(id)
);
"""

parser.parse_script(sql)
table = parser.get_table("products")

print(f"Table: {table.name}")
print(f"Primary Key: {table.primary_key.columns}")

for name, col in table.columns.items():
    print(f"\nColumn: {name}")
    print(f"  Type: {col.data_type}")
    print(f"  Nullable: {col.nullable}")
    
    if col.foreign_key_ref:
        ref_table, ref_col, _ = col.foreign_key_ref
        print(f"  References: {ref_table}.{ref_col}")</code></pre>
                </div>
                
                <h3>Handling ALTER TABLE Statements</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="btn-copy">Copy</button>
                    </div>
                    <pre><code>sql = """
ALTER TABLE products
ADD COLUMN description TEXT,
ADD CONSTRAINT unique_name UNIQUE (name),
ALTER COLUMN price SET NOT NULL;
"""

parser.parse_statement(sql)
table = parser.get_table("products")

print("New column:", "description" in table.columns)
print("Unique constraint:", any(c.ctype == "UNIQUE" for c in table.constraints))
print("Price nullable:", table.columns["price"].nullable)</code></pre>
                </div>
                
                <h3>Processing Views</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="btn-copy">Copy</button>
                    </div>
                    <pre><code>sql = """
CREATE VIEW expensive_products AS
SELECT * FROM products WHERE price > 100;
"""

parser.parse_script(sql)
view = parser.get_table("expensive_products")

print(f"View: {view.name}")
print(f"Definition: {view.view_definition[:50]}...")</code></pre>
                </div>
            </section>
            
            <section id="advanced-usage">
                <h2>Advanced Usage</h2>
                
                <h3>Processing Large Scripts</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="btn-copy">Copy</button>
                    </div>
                    <pre><code>with open("large_schema.sql", "r") as f:
    sql_script = f.read()

parser = SQLParser()

# Process statements incrementally
for stmt in parser.statement_generator(sql_script):
    parser.parse_statement(stmt)
    
    # Process new tables
    new_tables = parser.get_tables()
    for table in new_tables:
        save_to_database(table)</code></pre>
                </div>
                
                <h3>Generating Schema Reports</h3>
                <div class="code-block">
                    <div class="code-header">
                        <span>Python</span>
                        <button class="btn-copy">Copy</button>
                    </div>
                    <pre><code>def print_schema(parser: SQLParser):
    print("Database Schema Report\n" + "=" * 30)
    
    for table in parser.get_tables():
        print(f"\nTable: {table.get_qualified_name()} ({table.table_type})")
        
        # Print columns
        print("\nColumns:")
        for col in table.columns.values():
            details = [
                f"Type: {col.data_type}",
                f"Nullable: {col.nullable}",
                f"Primary: {col.is_primary}",
                f"Default: {col.default or 'None'}"
            ]
            print(f"- {col.name}: {', '.join(details)}")
        
        # Print constraints
        if table.primary_key:
            print(f"\nPrimary Key: {table.primary_key.name or 'N/A'}")
            print(f"  Columns: {', '.join(table.primary_key.columns)}")
        
        if table.foreign_keys:
            print("\nForeign Keys:")
            for fk in table.foreign_keys:
                print(f"- {fk.name or 'N/A'}: {', '.join(fk.columns)} â†’ {fk.ref_table}({', '.join(fk.ref_columns)})")
        
        if table.constraints:
            print("\nConstraints:")
            for constr in table.constraints:
                if constr.ctype == 'CHECK':
                    print(f"- {constr.name}: {constr.ctype} ({constr.expression})")
                else:
                    print(f"- {constr.name}: {constr.ctype} on {', '.join(constr.columns)}")
        
        print("\n" + "-" * 50)

# Generate report
parser.parse_script(schema_sql)
print_schema(parser)</code></pre>
                </div>
            </section>
            
            <section id="contributing">
                <h2>Contributing</h2>
                <p>Contributions are welcome! Please follow these steps:</p>
                
                <ol>
                    <li>Fork the repository</li>
                    <li>Create your feature branch (<code>git checkout -b feature/your-feature</code>)</li>
                    <li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
                    <li>Push to the branch (<code>git push origin feature/your-feature</code>)</li>
                    <li>Open a pull request</li>
                </ol>
                
                <h3>Guidelines</h3>
                <ul>
                    <li>Write clear commit messages</li>
                    <li>Include tests for new features</li>
                    <li>Update documentation as needed</li>
                    <li>Follow PEP 8 style guidelines</li>
                </ul>
            </section>
            
            <section id="license">
                <h2>License</h2>
                <p>This project is licensed under the MIT License.</p>
                <pre>MIT License

Copyright (c) [year] [fullname]

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</pre>
            </section>
            
            <div class="footer">
                <p>PostgreSQL SQL Parser &copy; 2023 | MIT License</p>
            </div>
        </main>
    </div>
    
    <script>
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                window.scrollTo({
                    top: targetElement.offsetTop - 80,
                    behavior: 'smooth'
                });
                
                // Update active link
                document.querySelectorAll('.sidebar a').forEach(link => {
                    link.classList.remove('active');
                });
                this.classList.add('active');
            });
        });
        
        // Copy button functionality
        document.querySelectorAll('.btn-copy').forEach(button => {
            button.addEventListener('click', function() {
                const codeBlock = this.closest('.code-block');
                const code = codeBlock.querySelector('code').innerText;
                
                navigator.clipboard.writeText(code).then(() => {
                    const originalText = this.innerText;
                    this.innerText = 'Copied!';
                    
                    setTimeout(() => {
                        this.innerText = originalText;
                    }, 2000);
                });
            });
        });
        
        // Set active link based on scroll position
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.sidebar a');
            
            let currentSection = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 100) {
                    currentSection = section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${currentSection}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>